# Requirements Archive: v1.0 OpenCode Teams MCP

**Archived:** 2026-02-08
**Status:** SHIPPED

For current requirements, see `.planning/PROJECT.md`.

---

## v1 Requirements

Requirements for OpenCode spawning support. All mapped to completed roadmap phases.

### Spawner Core (9/9)

- [x] **SPAWN-01**: System can discover OpenCode binary on PATH and validate version
- [x] **SPAWN-02**: System generates `.opencode/agents/<name>.md` config files dynamically per teammate
- [x] **SPAWN-03**: Generated agent configs include team identity (agent_id, team_name, color)
- [x] **SPAWN-04**: Generated agent configs include inbox polling instructions
- [x] **SPAWN-05**: Generated agent configs include task management instructions
- [x] **SPAWN-06**: System constructs `opencode run --agent <name>` spawn commands
- [x] **SPAWN-07**: System spawns OpenCode instances in tmux panes
- [x] **SPAWN-08**: System captures tmux pane ID and updates team config
- [x] **SPAWN-09**: System sends initial prompt to teammate inbox before spawn

### Model Configuration (4/4)

- [x] **MODEL-01**: System translates model names (sonnet/opus/haiku) to Kimi K2.5 provider format
- [x] **MODEL-02**: Generated configs specify moonshot-ai provider with kimi-k2.5 model
- [x] **MODEL-03**: System supports multiple providers (Novita, Moonshot, OpenRouter)
- [x] **MODEL-04**: Agent configs include proper provider credentials reference

### Reliability (4/4)

- [x] **RELY-01**: Spawn commands wrapped with timeout to prevent indefinite hangs
- [x] **RELY-02**: Generated agent configs set all tool permissions to "allow"
- [x] **RELY-03**: System can detect dead/hung agents via tmux pane status
- [x] **RELY-04**: System can force-kill unresponsive OpenCode instances

### MCP Integration (3/3)

- [x] **MCP-01**: Generated agent configs include claude-teams MCP server in tools
- [x] **MCP-02**: Teammates can access read_inbox, send_message, task_* tools via MCP
- [x] **MCP-03**: MCP server state shared across all spawned agents (filesystem backend)

### Desktop Support (3/3)

- [x] **DESK-01**: System can spawn OpenCode desktop app instead of CLI
- [x] **DESK-02**: Desktop spawning works on Windows, macOS, Linux
- [x] **DESK-03**: System tracks desktop process ID for lifecycle management

### Agent Templates (3/3)

- [x] **TMPL-01**: System provides pre-built agent templates for common roles
- [x] **TMPL-02**: Templates include: researcher, implementer, reviewer, tester
- [x] **TMPL-03**: Templates can be customized per-spawn via prompt injection

### Cleanup (5/5)

- [x] **CLEAN-01**: Remove discover_claude_binary() function
- [x] **CLEAN-02**: Remove build_spawn_command() Claude-specific logic
- [x] **CLEAN-03**: Remove Claude Code CLI flags (--agent-id, --team-name, etc.)
- [x] **CLEAN-04**: Update all tests to use OpenCode spawning
- [x] **CLEAN-05**: Update README and documentation

## Traceability (Final)

| Requirement | Phase | Status |
|-------------|-------|--------|
| SPAWN-01 | Phase 1 | Complete |
| SPAWN-02 | Phase 2 | Complete |
| SPAWN-03 | Phase 2 | Complete |
| SPAWN-04 | Phase 2 | Complete |
| SPAWN-05 | Phase 2 | Complete |
| SPAWN-06 | Phase 3 | Complete |
| SPAWN-07 | Phase 3 | Complete |
| SPAWN-08 | Phase 3 | Complete |
| SPAWN-09 | Phase 3 | Complete |
| MODEL-01 | Phase 1 | Complete |
| MODEL-02 | Phase 1 | Complete |
| MODEL-03 | Phase 1 | Complete |
| MODEL-04 | Phase 1 | Complete |
| RELY-01 | Phase 3 | Complete |
| RELY-02 | Phase 2 | Complete |
| RELY-03 | Phase 5 | Complete |
| RELY-04 | Phase 5 | Complete |
| MCP-01 | Phase 2 | Complete |
| MCP-02 | Phase 4 | Complete |
| MCP-03 | Phase 4 | Complete |
| DESK-01 | Phase 7 | Complete |
| DESK-02 | Phase 7 | Complete |
| DESK-03 | Phase 7 | Complete |
| TMPL-01 | Phase 6 | Complete |
| TMPL-02 | Phase 6 | Complete |
| TMPL-03 | Phase 6 | Complete |
| CLEAN-01 | Phase 8 | Complete |
| CLEAN-02 | Phase 8 | Complete |
| CLEAN-03 | Phase 8 | Complete |
| CLEAN-04 | Phase 8 | Complete |
| CLEAN-05 | Phase 8 | Complete |

**Coverage:**
- v1 requirements: 31 total
- Shipped: 31 (100%)
- Adjusted: 0
- Dropped: 0

---
*Archived: 2026-02-08 as part of v1.0 milestone completion*
